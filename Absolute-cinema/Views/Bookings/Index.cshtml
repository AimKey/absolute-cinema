@model IEnumerable<BusinessObjects.Models.Booking>

@{
    ViewData["Title"] = "Bookings";
}

<div class="container mx-auto py-10">
    <div class="mx-auto max-w-5xl rounded-2xl bg-gray-800 p-8 shadow-2xl">
        <div class="mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
            <h1 class="text-3xl font-bold text-white">Bookings</h1>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full overflow-hidden rounded-xl bg-gray-900 text-sm text-gray-200">
                <thead>
                    <tr class="bg-gray-700 text-gray-100">
                        <th class="px-4 py-3 text-left">Booking Date</th>
                        <th class="px-4 py-3 text-left">Tickets</th>
                        <th class="px-4 py-3 text-left">Total Price</th>
                        <th class="px-4 py-3 text-left">User</th>
                        <th class="px-4 py-3 text-left">Created At</th>
                        <th class="px-4 py-3 text-center">Status</th>
                        <th class="px-4 py-3 text-center">View</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        bool isPaid = item.Payment != null;

                        <tr class="border-b border-gray-700 transition hover:bg-gray-800/60 px-4 py-2">
                            <td class="px-4 py-2">@Html.DisplayFor(modelItem => item.BookingDate)</td>
                            <td class="px-4 py-2">@Html.DisplayFor(modelItem => item.NumberOfTickets)</td>
                            <td class="px-4 py-2">@item.TotalPrice.ToString("N0", System.Globalization.CultureInfo.GetCultureInfo("vi-VN")) ₫</td>
                            <td class="px-4 py-2">@Html.DisplayFor(modelItem => item.User.Email)</td>
                            <td class="px-4 py-2">@Html.DisplayFor(modelItem => item.CreatedAt)</td>
                            @{
                                if (isPaid)
                                {
                                    <td class="flex justify-center items-center px-4 py-2">
                                        <span class="rounded w-16 text-center py-2 bg-green-600 text-white-500 transition-all duration-150 hover:bg-green-700">Paid</span>
                                    </td>
                                } else
                                {
                                    <td class="flex justify-center items-center px-4 py-2">
                                        <span class="rounded w-16 text-center py-2 bg-red-600 text-white-500 transition-all duration-150 hover:bg-red-700">Not paid</span>
                                    </td>
                                }
                            }

                            <td class="px-4 py-2 text-center">
                                <a asp-action="BookingDetails" asp-route-bookingId="@item.Id" class="rounded-full bg-blue-600 px-4 py-1 font-bold text-white shadow transition-all duration-200 hover:bg-blue-700">View</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- Simple Pagination -->
        @if (ViewBag.TotalPages > 1)
        {
            <div class="mt-6 flex items-center justify-center space-x-2">
                <!-- Previous Button -->
                @if (ViewBag.CurrentPage > 1)
                {
                    <a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage - 1)" asp-route-pageSize="@ViewBag.PageSize"
                       class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-chevron-left mr-1"></i>Previous
                    </a>
                }
                else
                {
                    <span class="px-4 py-2 bg-gray-600 text-gray-400 rounded-lg cursor-not-allowed">
                        <i class="fas fa-chevron-left mr-1"></i>Previous
                    </span>
                }

                <!-- Page Numbers -->
                <div class="flex space-x-1">
                    @for (int i = 1; i <= ViewBag.TotalPages; i++)
                    {
                        if (i == ViewBag.CurrentPage)
                        {
                            <span class="px-3 py-2 bg-red-600 text-white rounded-lg font-semibold">@i</span>
                        }
                        else
                        {
                            <a asp-action="Index" asp-route-page="@i" asp-route-pageSize="@ViewBag.PageSize"
                               class="px-3 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">@i</a>
                        }
                    }
                </div>

                <!-- Next Button -->
                @if (ViewBag.CurrentPage < ViewBag.TotalPages)
                {
                    <a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage + 1)" asp-route-pageSize="@ViewBag.PageSize"
                       class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        Next<i class="fas fa-chevron-right ml-1"></i>
                    </a>
                }
                else
                {
                    <span class="px-4 py-2 bg-gray-600 text-gray-400 rounded-lg cursor-not-allowed">
                        Next<i class="fas fa-chevron-right ml-1"></i>
                    </span>
                }
            </div>

            <!-- Page Info -->
            <div class="mt-4 text-center text-gray-400 text-sm">
                Showing @(((ViewBag.CurrentPage - 1) * ViewBag.PageSize) + 1) to @Math.Min(ViewBag.CurrentPage * ViewBag.PageSize, ViewBag.TotalItems) of @ViewBag.TotalItems bookings
            </div>
        }
    </div>
</div>
